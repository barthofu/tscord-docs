"use strict";(self.webpackChunktscord_docs=self.webpackChunktscord_docs||[]).push([[4764],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(h,i(i({ref:t},p),{},{components:n})):a.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},89480:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const o={sidebar_position:10},i="Update and migrations",l={unversionedId:"bot/get-started/update",id:"bot/get-started/update",title:"Update and migrations",description:"General update guide",source:"@site/docs/bot/get-started/update.mdx",sourceDirName:"bot/get-started",slug:"/bot/get-started/update",permalink:"/docs/next/bot/get-started/update",draft:!1,editUrl:"https://github.com/barthofu/tscord-docs/tree/main/docs/bot/get-started/update.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Understand the template",permalink:"/docs/next/bot/get-started/understand-the-template"},next:{title:"Interactions",permalink:"/docs/next/bot/discord/interactions"}},s={},d=[{value:"General update guide",id:"general-update-guide",level:2},{value:"Migrations",id:"migrations",level:2},{value:"Custom events",id:"custom-events",level:4},{value:"<code>configs</code> alias",id:"configs-alias",level:4},{value:"Path aliases",id:"path-aliases",level:4},{value:"Environment variables",id:"environment-variables",level:4},{value:"Service and Injectable",id:"service-and-injectable",level:4}],p={toc:d};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"update-and-migrations"},"Update and migrations"),(0,r.kt)("h2",{id:"general-update-guide"},"General update guide"),(0,r.kt)("p",null,"TSCord is a template-kind of project, so updating it can really be harsh. ",(0,r.kt)("br",null),"\nHowever, here is an update guide that you can (quite) follow for each migration:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"cd")," into your project directory"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"git remote add tscord https://github.com/barthofu/tscord")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"git fetch origin")),(0,r.kt)("li",{parentName:"ol"},"Now, get the tag of the release you want to update to (ex: ",(0,r.kt)("inlineCode",{parentName:"li"},"v2.1"),")"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"git merge v2.1")," (replace ",(0,r.kt)("inlineCode",{parentName:"li"},"v2.1")," with the tag you want to)"),(0,r.kt)("li",{parentName:"ol"},"Resolve the conflicts (we highly recommend you to use the new merge editor of VSCode)"),(0,r.kt)("li",{parentName:"ol"},"Once you've resolved all the conflict, commit the changes"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"git remote rm tscord"))),(0,r.kt)("h2",{id:"migrations"},"Migrations"),(0,r.kt)("p",null,"This section contains useful information about some version migration."),(0,r.kt)("details",{title:"v2.0 to v2.1"},(0,r.kt)("summary",null,(0,r.kt)("strong",null,"v2.0 to v2.1")),(0,r.kt)("h4",{id:"custom-events"},"Custom events"),(0,r.kt)("p",null,"Events and Custom events, which used to both relay the ",(0,r.kt)("inlineCode",{parentName:"p"},"@On()")," decorator of ",(0,r.kt)("inlineCode",{parentName:"p"},"discordx"),", are now split."),(0,r.kt)("p",null,"Indeed, we've implemented our own event manager so custom events are split from the discord ones, so they don't have to execute the whole guards pipeline."),(0,r.kt)("p",null,"You'll have to replace all your custom events by the new ",(0,r.kt)("inlineCode",{parentName:"p"},"@OnCustom()")," decorators, and emit them via the ",(0,r.kt)("inlineCode",{parentName:"p"},"emit()")," method of the ",(0,r.kt)("inlineCode",{parentName:"p"},"EventManager")," service."),(0,r.kt)("h4",{id:"configs-alias"},(0,r.kt)("inlineCode",{parentName:"h4"},"configs")," alias"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"src/config")," folder has been renamed to ",(0,r.kt)("inlineCode",{parentName:"p"},"src/configs"),", and so for its path alias: ",(0,r.kt)("inlineCode",{parentName:"p"},"@config")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"@configs"),".")),(0,r.kt)("details",{title:"v2.2 to v2.3"},(0,r.kt)("summary",null,(0,r.kt)("strong",null,"v2.2 to v2.3")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"This migration is quite heavy, and you should be careful when updating to this version. It is mainly due to the fact that we've auto-formatted the code on nearly all the files."),(0,r.kt)("p",{parentName:"admonition"},"You should check changes commit-per-commit on the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/barthofu/tscord/pull/155"},"associated Github PR")," to see what has changed and adapt your code accordingly. "),(0,r.kt)("p",{parentName:"admonition"},"Sorry for the inconvenience.")),(0,r.kt)("h4",{id:"path-aliases"},"Path aliases"),(0,r.kt)("p",null,"All the internal ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig")," path aliases have changed from ",(0,r.kt)("inlineCode",{parentName:"p"},"@<module_name>")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"@/<module_name>")," (e.g: ",(0,r.kt)("inlineCode",{parentName:"p"},"@services")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"@/services"),"). ",(0,r.kt)("br",null)),(0,r.kt)("p",null,"You should replace all the old path aliases by the new ones (quite fast to do with the global research/replace feature of your IDE)."),(0,r.kt)("h4",{id:"environment-variables"},"Environment variables"),(0,r.kt)("p",null,"We now use ",(0,r.kt)("inlineCode",{parentName:"p"},"envalid")," to validate the environment variables upon startup. ",(0,r.kt)("br",null)),(0,r.kt)("p",null,"You shouldn't import them from ",(0,r.kt)("inlineCode",{parentName:"p"},"process.env")," anymore. Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"env")," object from the ",(0,r.kt)("inlineCode",{parentName:"p"},"@/env")," module instead."),(0,r.kt)("h4",{id:"service-and-injectable"},"Service and Injectable"),(0,r.kt)("p",null,"Three ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/microsoft/tsyringe"},"tsyringe")," decorators have been replaced by custom wrappers importable from ",(0,r.kt)("inlineCode",{parentName:"p"},"@/decorators"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@singleton()")," -> ",(0,r.kt)("inlineCode",{parentName:"li"},"@Service()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@injectable()")," -> ",(0,r.kt)("inlineCode",{parentName:"li"},"@Injectable()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@autoInjectable()")," -> ",(0,r.kt)("inlineCode",{parentName:"li"},"@AutoInjectable()")))))}c.isMDXComponent=!0}}]);